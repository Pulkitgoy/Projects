import { JwtPayload, verify } from 'jsonwebtoken'
import { generateJwt } from './jwt'

it('should generate a valid JWT with the correct API key as signature', async () => {
  const signature = 'TEST_SIGNATURE'
  const appId = 'TEST_APP_ID'

  const jwt = await generateJwt(signature, appId)
  expect(jwt).toBeDefined()

  const decoded = verify(jwt!, signature) as JwtPayload

  expect(decoded.appId).toBe(appId)
  expect(decoded.iat).toBeDefined()
})
